# OpenWRT WAN led
#### Написан для TP-Link Archer C50 но можно немного поправив использовать на любом роутере под управлением OpenWRT

Данный скрипты можно использовать если у вас на роутере есть двухцветный светодиод.
Так же можно менять яркость светодиода если он одноцветный

---
### В первом и основном скрипте (inet-status) 
Написан бесконечный цикл в котором проверкой доступности интернета каждые 10 секунд с помощью пинга 8.8.8.8:
* Если пинг не проходит то выключается один цвет и включается второй.
* Если пинг проходит, выключатся второй цвет и включается первый 
(либо остаётся включён первый в случае если он и был включен).
* Так же в скрипте реализована проверка на наличие линка. Если его нет то светодиод выключается.

В скрипте есть переменные:
``` bash
wan-led-color2='/sys/class/leds/c50-v3:orange:wan/brightness'
wan-led-color1='/sys/class/leds/c50-v3:green:wan/brightness'
```
> Где: 
Вам вместо c50-v3:green:wan необходимо указать свои светодиоды для вашего роутера
Усли у вас один светодиод то нужно закоментировать одну из строк.

Смена цвета или яркости выполняется следующим образом:
``` bash
echo 0 > $wan-led-color2
echo 255 > $wan-led-color1
```
>Где:
От нуля до 255 указывается яркость светодиода
Переменными указывается цвет

--- 
Данный скрипт необходимо положить по пути: 
```bash
/usr/bin/inet-status 
```
> Где inet-status и есть скрипт.

Также необходимо сделать его исполняемым: 
```bash
chmod +x /usr/bin/inet-status
```
---
### Во втором скрипте (netstatus) 
Реализована управлять работой первого через /etc/init.d/
В нём описан: 
* Запуск первого скрипта в фоне при вызове
``` bash
/etc/init.d/netstatus start
```
* Завершение работы первого скрипта при вызове
``` bash
/etc/init.d/netstatus stop
```
* Так же можно добавить запуск скрипта при загрузке
``` bash
/etc/init.d/netstatus enable
```
Скрипт необходимо положить по пути: 
``` bash
/etc/init.d/netstatus
```
> Где netstatus и есть скрипт.

Также необходимо сделать его исполняемым: 
``` bash
chmod +x /etc/init.d/netstatus
```
